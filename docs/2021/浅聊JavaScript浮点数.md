## æµ…èŠ JavaScript æµ®ç‚¹æ•°

### èƒŒæ™¯

åœ¨å®žé™…å¼€å‘ä¸­ï¼Œæœ‰ä¸€ä¸ªåœºæ™¯ api è¿”å›žäº†æ¯«ç§’ 128639ï¼Œæµè§ˆå™¨ä¾§éœ€è¦ä»¥ç§’ä¸ºå•ä½å±•ç¤ºï¼Œé™¤ä»¥1000å¾—åˆ° 128.639ï¼Œæœ€åŽæäº¤çš„æ—¶å€™åˆå°†ç§’ä¹˜ä»¥1000ä»¥æ¯«ç§’ä¸ºå•ä½æäº¤ã€‚ç„¶åŽ 128.639 * 1000 = 128639.00000000001ï¼Œå¯¼è‡´ç±»åž‹æŠ¥é”™

### ç»å…¸é—®é¢˜

ä¸ºä»€ä¹ˆ 0.1 + 0.1 = 0.2 ä½†æ˜¯ 0.1 + 0.2 = 0.30000000000000004 å‘¢? 

[0.30000000000000004.com](http://0.30000000000000004.com) å±•ç¤ºäº†å„ä¸ªè¯­è¨€å¯¹ 0.1 + 0.2 çš„è¡¨çŽ°ï¼Œå¯ä»¥çœ‹åˆ°å¾ˆå¤šè¯­è¨€è®¡ç®—çš„ç»“æžœéƒ½æ˜¯0.30000000000000004



æˆ‘ä»¬çŸ¥é“è®¡ç®—æœºåªè®¤è¯†0å’Œ1ï¼ˆä¸ºä»€ä¹ˆåªèƒ½æ˜¯0å’Œ1å¯ä»¥å•ç‹¬çœ‹çœ‹æ•°ç”µï¼‰ï¼Œæ‰€æœ‰çš„æ•°æ®éœ€è¦é€šè¿‡è®¡ç®—æœºå­˜å‚¨ã€è®¡ç®—æˆ–è€…å±•ç¤ºï¼Œéƒ½éœ€è¦è½¬æ¢2è¿›åˆ¶ã€‚å›žé¡¾ä¸€ä¸‹è®¡ç®—æœºæ˜¯æ€Žä¹ˆå­˜å‚¨äºŒè¿›åˆ¶çš„[è¡¥ç -è®¡ç®—æœºå­˜å‚¨æ•°æ®çš„æ–¹å¼](https://tech.bytedance.net/articles/6972202414157856775)



æ‰€ä»¥é’ˆå¯¹ä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¾—å…ˆçŸ¥é“æ€Žä¹ˆå°†åè¿›åˆ¶è½¬æ¢ä¸ºäºŒè¿›åˆ¶ï¼š

- æ•´æ•°ï¼šé™¤2å–ä½™ï¼Œç”±ä¸‹å¾€ä¸Šå–ç»“æžœ
- å°æ•°ï¼šä¹˜2å–æ•´ï¼Œç”±ä¸Šå¾€ä¸‹å–ç»“æžœ

æ¯”å¦‚ï¼š

10 è½¬ä¸ºäºŒè¿›åˆ¶ä¸ºï¼š

1.10 / 2 = 5 ä½™ 0

2.5 / 2 = 2 ä½™ 1

3.2 / 2 = 1 ä½™ 0

4.1 / 2 = 0 ä½™ 1

ç»“æžœï¼š1010

0.1 è½¬äºŒè¿›åˆ¶ä¸ºï¼š

1.0.1 * 2 = 0.2 æ•´ 0

2.0.2 * 2 = 0.4 æ•´ 0

3.0.4 * 2 = 0.8 æ•´ 0

4.0.8 * 2 = 1.6 æ•´ 1

5.0.6 * 2 = 1.2 æ•´ 1

6.0.2 * 2 = 0.4 æ•´ 0

**ä»Ž0.2å¼€å§‹å¾ªçŽ¯**

ç»“æžœä¸ºï¼š0.00011001100110011001100110011001100110011001100110011001...

**ç”±æ­¤å¯è§ï¼Œ0.1æ²¡åŠžæ³•è½¬æ¢æˆä¸€ä¸ªç¡®å®šçš„äºŒè¿›åˆ¶æ•°**

åŒç†0.2è½¬ä¸ºäºŒè¿›åˆ¶ä¸ºï¼š0.00110011001100110011001100110011001100110011001100110011...

0.1 + 0.2 çš„äºŒè¿›åˆ¶æ•°ä¸ºï¼š0.010011001100110011001100110011001100110011001100110011...

**æ‰€ä»¥0.1 + 0.2åœ¨äºŒè¿›åˆ¶é‡Œå®žé™…ä¸Šæ˜¯æ— é™å¾ªçŽ¯å°æ•°**

ä¸ºäº†è§£å†³éƒ¨åˆ†å°æ•°æ— æ³•ä½¿ç”¨äºŒè¿›åˆ¶ç²¾ç¡®è¡¨ç¤ºçš„é—®é¢˜ï¼ŒäºŽæ˜¯å°±æœ‰äº†IEEE 754è§„èŒƒï¼ˆæµ®ç‚¹æ•°ç®—æœ¯æ ‡å‡†ï¼‰ã€‚IEEE 754è§„å®šäº†å››ç§è¡¨ç¤ºæµ®ç‚¹æ•°å€¼çš„æ–¹å¼ï¼šå•ç²¾ç¡®åº¦ï¼ˆ32ä½ï¼‰ã€åŒç²¾ç¡®åº¦ï¼ˆ64ä½ï¼‰ã€å»¶ä¼¸å•ç²¾ç¡®åº¦ï¼ˆ43æ¯”ç‰¹ä»¥ä¸Šï¼Œå¾ˆå°‘ä½¿ç”¨ï¼‰ä¸Žå»¶ä¼¸åŒç²¾ç¡®åº¦ï¼ˆ79æ¯”ç‰¹ä»¥ä¸Šï¼Œé€šå¸¸ä»¥80ä½å®žçŽ°ï¼‰ã€‚

å…¶ä¸­æœ€å¸¸ç”¨çš„å°±æ˜¯32ä½å•ç²¾åº¦æµ®ç‚¹æ•°(float)å’Œ64ä½åŒç²¾åº¦æµ®ç‚¹æ•°(double)ã€‚

**js ä½¿ç”¨ 64 ä½å›ºå®šé•¿åº¦æ¥è¡¨ç¤ºï¼Œä¹Ÿå°±æ˜¯æ ‡å‡†çš„ double åŒç²¾åº¦æµ®ç‚¹æ•°**

64ä½åˆå¯åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š

- ç¬¦å·ä½Sï¼šç¬¬ 1 ä½æ˜¯æ­£è´Ÿæ•°ç¬¦å·ä½ï¼ˆsignï¼‰ï¼Œ0ä»£è¡¨æ­£æ•°(å¤§äºŽç­‰äºŽ0)ï¼Œ1ä»£è¡¨è´Ÿæ•°(å°äºŽ0)
- æŒ‡æ•°ä½Eï¼šä¸­é—´çš„ 11 ä½å­˜å‚¨æŒ‡æ•°ï¼ˆexponentï¼‰ï¼Œè¡¨ç¤ºæŒ‡æ•°ä½
- å°¾æ•°ä½Mï¼šæœ€åŽçš„ 52 ä½æ˜¯å°¾æ•°ï¼ˆmantissaï¼‰ï¼Œè¡¨ç¤ºæœ‰æ•ˆæ•°å­—ï¼Œå¤§äºŽç­‰äºŽ1å°äºŽ2

![](../images/2021/SEM.png)

IEEEæ ‡å‡†é‡‡ç”¨ç±»ä¼¼äºŽç§‘å­¦è®¡æ•°æ³•çš„æ–¹å¼è¡¨ç¤ºæµ®ç‚¹å°æ•°ï¼Œæµ®ç‚¹æ•°å€¼ç”±å¦‚ä¸‹å…¬å¼è¡¨ç¤ºï¼š

![](../images/2021/IEEE.png)

**æ³¨æ„ï¼ŒIEEE 754 å¯¹ M å’Œ E æœ‰ä¸€äº›ç‰¹æ®Šè§„å®š**

Mï¼šåœ¨è®¡ç®—æœºå†…éƒ¨ä¿å­˜Mæ—¶ï¼Œé»˜è®¤è¿™ä¸ªæ•°çš„ç¬¬ä¸€ä½æ€»æ˜¯1ï¼Œå› æ­¤å¯ä»¥è¢«èˆåŽ»ï¼Œåªä¿å­˜åŽé¢çš„å°æ•°éƒ¨åˆ†ã€‚æ¯”å¦‚ä¿å­˜1.01çš„æ—¶å€™ï¼Œåªä¿å­˜01ï¼Œç­‰åˆ°è¯»å–çš„æ—¶å€™ï¼Œå†æŠŠç¬¬ä¸€ä½çš„1åŠ ä¸ŠåŽ»ã€‚è¿™æ ·åšçš„ç›®çš„ï¼Œæ˜¯èŠ‚çœ1ä½æœ‰æ•ˆæ•°å­—ã€‚ä»¥64ä½æµ®ç‚¹æ•°ä¸ºä¾‹ï¼Œç•™ç»™Måªæœ‰52ä½ï¼Œå°†ç¬¬ä¸€ä½çš„1èˆåŽ»ä»¥åŽï¼Œç­‰äºŽå¯ä»¥ä¿å­˜53ä½æœ‰æ•ˆæ•°å­—ã€‚

Eï¼šEæ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ï¼ˆunsigned intï¼‰ã€‚64ä½é‡Œé¢11ä½çš„Eï¼Œå®ƒçš„å–å€¼èŒƒå›´ä¸º0~2047ã€‚ä½†æ˜¯Eä½œä¸ºæŒ‡æ•°æ¥è¯´æ˜¯å¯æ­£å¯è´Ÿçš„ï¼Œæ‰€ä»¥IEEE 754è§„å®šï¼ŒEçš„çœŸå®žå€¼éœ€è¦åŠ ä¸Šåç§»é‡æ‰èƒ½å¾—åˆ°æœ€ç»ˆå€¼ï¼Œ8ä½çš„Eæ˜¯127ï¼›11ä½çš„Eæ˜¯1023ã€‚
> E ä¸ºå…¨ 0 æ—¶ï¼šè¿™æ—¶ï¼Œæµ®ç‚¹æ•°çš„æŒ‡æ•°Eç­‰äºŽ1-127ï¼ˆæˆ–è€…1-1023ï¼‰ï¼Œæœ‰æ•ˆæ•°å­—Mä¸å†åŠ ä¸Šç¬¬ä¸€ä½çš„1ï¼Œè€Œæ˜¯è¿˜åŽŸä¸º0.xxxxxxçš„å°æ•°ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†è¡¨ç¤ºÂ±0ï¼Œä»¥åŠæŽ¥è¿‘äºŽ0çš„å¾ˆå°çš„æ•°å­—ã€‚
> 
> E ä¸ºå…¨ 1 æ—¶ï¼šè¿™æ—¶ï¼Œå¦‚æžœæœ‰æ•ˆæ•°å­—Må…¨ä¸º0ï¼Œè¡¨ç¤ºÂ±æ— ç©·å¤§ï¼ˆæ­£è´Ÿå–å†³äºŽç¬¦å·ä½sï¼‰ï¼›å¦‚æžœæœ‰æ•ˆæ•°å­—Mä¸å…¨ä¸º0ï¼Œè¡¨ç¤ºè¿™ä¸ªæ•°ä¸æ˜¯ä¸€ä¸ªæ•°ï¼ˆNaNï¼‰ã€‚

#### ä¸¾ä¸ªä¾‹å­ðŸŒ°

å°† -0.11 ç”¨ IEEE754 æ ¼å¼è¡¨ç¤º

1. ç¬¦å·S: è´Ÿæ•°ï¼Œ1
2. æŒ‡æ•°ä½Eï¼š0.11 = 1.1 * 2^-1 (äºŒè¿›åˆ¶)ï¼ŒE = 1023 + (-1) = 1022 = 01111111110(äºŒè¿›åˆ¶)
3. å°¾æ•°ä½Mï¼š0.1.....0

æ‰€ä»¥è¯¥æµ®ç‚¹æ•°æ ¼å¼ä¸º: 1 01111111110 1...000(ä¸€å…±52ä¸ª0)

**ä½†æ˜¯ï¼ŒIEEE754å¹¶æ²¡æœ‰è§£å†³å°æ•°æ— æ³•ç²¾ç¡®è¡¨ç¤ºçš„é—®é¢˜ï¼Œåªæ˜¯æå‡ºäº†ä¸€ç§ä½¿ç”¨è¿‘ä¼¼å€¼è¡¨ç¤ºå°æ•°çš„æ–¹å¼ï¼Œå¹¶ä¸”å¼•å…¥äº†ç²¾åº¦çš„æ¦‚å¿µã€‚**

**å¯¹äºŽæ— é™å¾ªçŽ¯çš„äºŒè¿›åˆ¶æ•°ï¼Œåœ¨è®¡ç®—æœºä¸­çš„è¡¨ç¤ºæ˜¯è¿‘ä¼¼æ•°ï¼Œå¹¶ä¸æ˜¯çœŸå®žå€¼ã€‚æ ¹æ®ç²¾åº¦ä¸åŒï¼Œè¿‘ä¼¼ç¨‹åº¦ä¹Ÿæœ‰æ‰€ä¸åŒã€‚**

**æ‰€ä»¥ç”¨è¿‘ä¼¼å€¼è¿ç®—å°±è‚¯å®šå­˜åœ¨ç²¾åº¦çš„é—®é¢˜ï¼Œå¾—åˆ°åªèƒ½æ˜¯è¿‘ä¼¼å€¼ï¼Œä¸æ˜¯çœŸå®žå€¼ã€‚**



#### è¿½é—®

##### ä¸ºä»€ä¹ˆ js é‡‡ç”¨ 64 ä½åŒç²¾åº¦ï¼Œå´ä¸èƒ½è¡¨ç¤º int64ï¼Ÿ

ä¸Šé¢è¯´è¿‡å®žé™…ä¸ŠMæœ€å¤šå¯ç”¨53ä½ï¼Œå½“Eä¸º52æ—¶ï¼ŒäºŒè¿›åˆ¶ 1.52ä¸ªx * 2^52 = 1x(52ä¸ªx)ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆè¯´èƒ½å®‰å…¨è¡¨ç¤º(-2^53, 2^53)èŒƒå›´å†…çš„æ•°

> (-2^53, 2^53) ä¸ºä»€ä¹ˆæ˜¯å¼€åŒºé—´ä¸æ˜¯é—­åŒºé—´ï¼Ÿ
> 
> 2^53 ä¸å®‰å…¨åœ¨å“ªï¼Ÿ
> 
> Math.pow(2,53) === Math.pow(2,53) + 1  // true
> 
> Number.MAX_SAFE_INTEGER === Math.pow(2,53) - 1 // true

å¯¹äºŽæ•´æ•°ï¼Œ[æ ¹æ®ECMA 262-5 æ ‡å‡†](https://262.ecma-international.org/5.1/#sec-8.5)ï¼ŒJavaScriptèƒ½è¡¨ç¤ºå¹¶è¿›è¡Œç²¾ç¡®ç®—æœ¯è¿ç®—çš„æ•´æ•°èŒƒå›´ä¸ºï¼šæ­£è´Ÿ2çš„53æ¬¡æ–¹ï¼Œä¹Ÿå³ä»Žæœ€å°å€¼-9007199254740992åˆ°æœ€å¤§å€¼+9007199254740992ä¹‹é—´çš„èŒƒå›´ï¼›å¯¹äºŽè¶…è¿‡è¿™ä¸ªèŒƒå›´çš„æ•´æ•°ï¼ŒJavaScriptä¾æ—§å¯ä»¥è¿›è¡Œè¿ç®—ï¼Œä½†å´ä¸ä¿è¯è¿ç®—ç»“æžœçš„ç²¾åº¦ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºŽæ•´æ•°çš„ä½è¿ç®—ï¼ˆæ¯”å¦‚ç§»ä½ç­‰æ“ä½œï¼‰ï¼ŒJavaScriptä»…æ”¯æŒ32ä½æ•´åž‹æ•°ï¼Œä¹Ÿå³ä»Ž-2147483648åˆ°+2147483647ä¹‹é—´çš„æ•´æ•°ã€‚

#### 0.1 ä¸æ˜¯ 0.1

ä¸ºä»€ä¹ˆ const  a = 0.1ï¼Œæ‰“å° a å¾—åˆ°çš„æ˜¯ 0.1 è€Œä¸æ˜¯ æ— é™å°æ•°ï¼Ÿ

è¯•ä¸€ä¸‹ 0.1.toPrecision(20) // 0.10000000000000000555

**å®žé™…ä¸Šæˆ‘ä»¬çœ‹åˆ°çš„ 0.1 å¹¶ä¸æ˜¯çœŸæ­£çš„ 0.1ã€‚**

ä¸Šé¢è¯´è¿‡å®žé™…ä¸ŠMæœ€å¤šå¯ç”¨53ä½ï¼Œç›¸å½“äºŽäºŒè¿›åˆ¶ç²¾åº¦ï¼Œè½¬æˆåè¿›åˆ¶ç²¾åº¦ä¸º 16 ä½ã€‚è€…ç”± Number.EPSILON å¯çŸ¥ js çš„æœ€å°ç²¾åº¦ä¸º 2.220446049250313e-16ã€‚

ä¾‹å¦‚æœ€å¤§æ­£æ•´æ•° 2^53=9007199254740992ï¼Œåè¿›åˆ¶ä¸‹ç§‘å­¦è®°æ•°æ³•ä¸º9.007199254740992e-16

æ‰€ä»¥ js æœ€å¤šèƒ½è¡¨ç¤ºçš„åè¿›åˆ¶ç²¾åº¦çš„é•¿åº¦æ˜¯å°æ•°ç‚¹åŽé¢çš„ 16 ä½ã€‚æ‰€ä»¥å¯ä»¥ä½¿ç”¨ toPrecision(16) æ¥åšç²¾åº¦è¿ç®—ï¼Œjsè‡ªåŠ¨åšäº†è¿™ä¸€éƒ¨åˆ†å¤„ç†ï¼Œè¶…è¿‡çš„ç²¾åº¦ä¼šè‡ªåŠ¨åšå‡‘æ•´å¤„ç†

0.10000000000000000555.toPrecision(16) // 0.1000000000000000

#### toFixed Bug

**ä¸ºä»€ä¹ˆ1.005.toFixed(2) ç»“æžœä¸º 1.00 è€Œä¸æ˜¯ 1.01ï¼Ÿ**

1.005.toPrecision(17) = 1.0049999999999999 å››èˆäº”å…¥æ—¶åŽé¢çš„æ•°å®žé™…ä¸Šä¸è¶³5ä¼šè¢«å…¨éƒ¨èˆåŽ»

Math.round(1.005 * 100) / 100 = 1 ä¹Ÿæ²¡ç”¨

è§£å†³åŠžæ³•å¾€ä¸‹çœ‹ æ–¹æ³•ä¸€ æ”¹è‰¯ç‰ˆ multiply

##### Number.isInteger() Bug

**ä¸ºä»€ä¹ˆ Number.isInteger(1.0000000000000001) = true ï¼Ÿ**

`1.0000000000000001` è½¬æ¢ä¸ºäºŒè¿›åˆ¶ä¸º `1.(53ä¸ª0)11100`ï¼Œè¶…è¿‡äº†Mçš„53ä¸ªäºŒè¿›åˆ¶ä½ï¼Œå¯¼è‡´æœ€åŽçš„111è¢«ä¸¢å¼ƒäº†ï¼Œæœ€ç»ˆ `1.(53ä¸ª0) = 1`

**ä¸ºä»€ä¹ˆ Number.isInteger(5e-325) = true ï¼Ÿ**

Number.MIN_VALUE = 5e-324ï¼Œè¡¨ç¤ºäº† js èƒ½åˆ†è¾¨çš„æœ€å°å€¼ï¼Œå¦‚æžœå°äºŽjsèƒ½å¤Ÿåˆ†è¾¨çš„æœ€å°å€¼ï¼Œä¼šè¢«è‡ªåŠ¨è½¬ä¸º 0ã€‚è¿™æ—¶ï¼Œ**Number.isInteger** å°±ä¼šè¯¯åˆ¤

### è§£å†³æ–¹æ¡ˆ

#### æ–¹æ³•ä¸€

##### æ™®é€šç‰ˆ

å°†æµ®ç‚¹æ•°è½¬ä¸ºæ•´æ•°ï¼Œç­‰è®¡ç®—å®Œä¹‹åŽï¼Œå†è½¬å›žæµ®ç‚¹æ•°


```
const add1 = (n1, n2) => {

  const n1Precision = (n1.toString().split(".")[1] || '').length;

  const n2Precision = (n2.toString().split(".")[1] || '').length;

  const pow = Math.max(n1Precision, n2Precision);

  const base = Math.pow(10, pow);

  return (n1 * base + n2 * base) / base

}
```

ç¼ºç‚¹ï¼š

- å½“é‡åˆ°ç§‘å­¦è®¡æ•°æ³•å¦‚ 2.3e+1ï¼ˆå½“æ•°å­—ç²¾åº¦å¤§äºŽ21æ—¶ï¼Œæ•°å­—ä¼šå¼ºåˆ¶è½¬ä¸ºç§‘å­¦è®¡æ•°æ³•å½¢å¼æ˜¾ç¤ºï¼‰æ—¶è¿™ä¸ªæ–¹æ³•å°±ä¸ç®¡ç”¨äº†
- å°æ•°ä¹˜æ³•è®¡ç®—çš„æ—¶å€™ä¹Ÿä¼šæœ‰ç²¾åº¦é—®é¢˜ï¼Œæ¯”å¦‚ 0.55 * 100 = 55.00000000000001ï¼Œå…¶å®žè¿˜æ˜¯æœ‰ç²¾åº¦ç¼ºå¤±é—®é¢˜

##### æ”¹è‰¯ç‰ˆ

```
/**

 * èŽ·å–æµ®ç‚¹æ•°å°æ•°éƒ¨åˆ†é•¿åº¦

 * @param {number} n 

 * @returns {number}

 */

const getPrecisionLength = n => {

  const [str, strLen] = n.toString().split(/[eE]/);

  const length = (str.split('.')[1] || '').length - Number(strLen || 0);

  return length > 0 ? length : 0;

}



/**

 * å°†å‚æ•°è½¬æˆæŒ‡å®šç²¾åº¦

 * @param {number} n 

 * @param {number} p 

 * @returns {number}

 */

const getPrecisionNumber = (n, p = 16) => Number(Number(n).toPrecision(p));



/**

 * å°æ•°æ”¾å¤§æˆæ•´æ•°

 * @param {number} n 

 * @returns {number}

 */

const float2Int = n => {

  const len = getPrecisionLength(n);

  const v = len > 0 ? getPrecisionNumber(Number(n) * Math.pow(10, len)) : Number(n);

  if (v > Number.MAX_SAFE_INTEGER || v < Number.MIN_SAFE_INTEGER) {

    throw new Error('è¶Šç•Œ');

  }

  return v;

}



/**

 * ä¹˜

 * @param {number} n1 

 * @param {number} n2 

 * @returns {number}

 */

const multiply = (n1, n2) => {

  const int1 = float2Int(n1);

  const int2 = float2Int(n2);

  const value = int1 * int2;

  if (value > Number.MAX_SAFE_INTEGER || value < Number.MIN_SAFE_INTEGER) {

    throw new Error('è¶Šç•Œ');

  }

  return value / Math.pow(10, getPrecisionLength(n1) + getPrecisionLength(n2));

}



/**

 * åŠ 

 * @param {number} n1 

 * @param {number} n2 

 * @returns {number}

 */

const plus = (n1, n2) => {

  const base = Math.pow(10, Math.max(getPrecisionLength(n1), getPrecisionLength(n2)));

  return (multiply(n1, base) + multiply(n2, base)) / base;

}
```

#### æ–¹æ³•äºŒ

æ—¢ç„¶æ˜¯ä¸ºäº†æŠŠæµ®ç‚¹æ•°è½¬æˆæ•´æ•°è®¡ç®—ï¼Œé‚£ä¸å¦‚ç›´æŽ¥æŠŠæµ®ç‚¹æ•°è½¬æˆå­—ç¬¦ä¸²ï¼Œå†åŽ»æŽ‰å°æ•°ç‚¹ï¼Œå°±å¯ä»¥ä¸ç”¨ä¹˜æ³•è®¡ç®—å°±å¾—åˆ°æ•´æ•°ã€‚

```
const add2 = (n1, n2) => {

  const n1Precision = (n1.toString().split(".")[1] || '').length;

  const n2Precision = (n2.toString().split(".")[1] || '').length;

  const pow = Math.max(n1Precision, n2Precision);

  const base = Math.pow(10, pow)



  const intN1 = Number(n1.toString().replace(".", ""));

  const intN2 = Number(n2.toString().replace(".", ""));



  const x = n1Precision < n2Precision ? intN1 * Math.pow(10, (n2Precision - n1Precision)) : intN1;

  const y = n2Precision < n1Precision ? intN2 * Math.pow(10, (n1Precision - n2Precision)) : intN2;



  return (x + y) / base

}
```


**æœ€åŽï¼šå»ºè®®ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ bignumber.jsï¼ŒåŽŸç†æ˜¯æŠŠæ‰€æœ‰æ•°å­—å½“ä½œå­—ç¬¦ä¸²ï¼Œé‡æ–°å®žçŽ°äº†è®¡ç®—é€»è¾‘ï¼Œç¼ºç‚¹æ˜¯æ€§èƒ½æ¯”åŽŸç”Ÿçš„å·®å¾ˆå¤šã€‚**


